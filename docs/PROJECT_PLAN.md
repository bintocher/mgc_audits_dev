# MGC Audits - План разработки и оценка

## Версия: 1.0
## Дата: 02.10.2025

---

## 5. API Спецификация (FastAPI, /api/v1)

### 5.1. Эндпоинты аутентификации

```
POST   /api/v1/auth/login              # Вход по email+пароль
POST   /api/v1/auth/login/otp          # Запрос OTP на email
POST   /api/v1/auth/login/otp/verify   # Вход по OTP
POST   /api/v1/auth/login/ldap         # Вход через LDAP
POST   /api/v1/auth/logout             # Выход
POST   /api/v1/auth/refresh            # Обновление JWT токена
GET    /api/v1/users/me                # Текущий пользователь
PATCH  /api/v1/users/me                # Обновление профиля
POST   /api/v1/auth/telegram/link      # Ссылка для привязки Telegram
POST   /api/v1/auth/telegram/unlink    # Отвязать Telegram
```

### 5.2. Эндпоинты пользователей и ролей

```
GET    /api/v1/users                   # Список пользователей
POST   /api/v1/users                   # Создать пользователя
GET    /api/v1/users/{id}              # Детали пользователя
PATCH  /api/v1/users/{id}              # Обновить пользователя
DELETE /api/v1/users/{id}              # Мягкое удаление

GET    /api/v1/roles                   # Список ролей
POST   /api/v1/roles                   # Создать роль
GET    /api/v1/roles/{id}              # Детали роли
PATCH  /api/v1/roles/{id}              # Обновить роль
DELETE /api/v1/roles/{id}              # Мягкое удаление
GET    /api/v1/roles/{id}/permissions  # Права роли
POST   /api/v1/roles/{id}/permissions  # Добавить права
```

### 5.3. Эндпоинты предприятий

```
GET    /api/v1/enterprises             # Список предприятий
POST   /api/v1/enterprises             # Создать предприятие
GET    /api/v1/enterprises/{id}        # Детали предприятия
PATCH  /api/v1/enterprises/{id}        # Обновить предприятие
DELETE /api/v1/enterprises/{id}        # Мягкое удаление
```

### 5.4. Эндпоинты справочников

```
GET    /api/v1/dictionaries/processes
POST   /api/v1/dictionaries/processes
GET    /api/v1/dictionaries/processes/{id}
PATCH  /api/v1/dictionaries/processes/{id}
DELETE /api/v1/dictionaries/processes/{id}

GET    /api/v1/dictionaries/norms
POST   /api/v1/dictionaries/nормs
GET    /api/v1/dictionaries/norms/{id}
PATCH  /api/v1/dictionaries/norms/{id}
DELETE /api/v1/dictionaries/norms/{id}

GET    /api/v1/dictionaries/audit-types
GET    /api/v1/dictionaries/products
GET    /api/v1/dictionaries/projects
...
```

### 5.5. Эндпоинты планирования аудитов

```
GET    /api/v1/audit-plans             # Список планов аудитов
POST   /api/v1/audit-plans             # Создать план аудитов
GET    /api/v1/audit-plans/{id}        # Детали плана аудитов
PATCH  /api/v1/audit-plans/{id}        # Обновить план аудитов
DELETE /api/v1/audit-plans/{id}        # Мягкое удаление
POST   /api/v1/audit-plans/{id}/approve# Утвердить план
GET    /api/v1/audit-plans/{id}/items  # Пункты плана

GET    /api/v1/audit-plan-items        # Список пунктов плана
POST   /api/v1/audit-plan-items        # Создать пункт плана
GET    /api/v1/audit-plan-items/{id}   # Детали пункта плана
PATCH  /api/v1/audit-plan-items/{id}   # Обновить пункт плана
DELETE /api/v1/audit-plan-items/{id}   # Мягкое удаление
```

### 5.6. Эндпоинты квалификации аудиторов

```
GET    /api/auditor-qualifications/    # Список квалификаций
POST   /api/auditor-qualifications/    # Создать квалификацию
GET    /api/auditor-qualifications/{id}/ # Детали квалификации
PATCH  /api/auditor-qualifications/{id}/ # Обновить квалификацию
DELETE /api/auditor-qualifications/{id}/ # Мягкое удаление

GET    /api/users/{id}/qualifications/ # Квалификации пользователя
GET    /api/users/{id}/audit-stats/    # Статистика аудитов пользователя
```

### 5.7. Эндпоинты аудитов

```
GET    /api/v1/audits                  # Список аудитов (с фильтрами)
POST   /api/v1/audits                  # Создать аудит
GET    /api/v1/audits/{id}             # Детали аудита
PATCH  /api/v1/audits/{id}             # Обновить аудит
DELETE /api/v1/audits/{id}             # Мягкое удаление
GET    /api/v1/audits/{id}/findings    # Findings аудита
GET    /api/v1/audits/{id}/history     # История изменений
```

### 5.8. Эндпоинты findings

```
GET    /api/v1/findings                # Список findings (с фильтрами)
POST   /api/v1/findings                # Создать finding
GET    /api/v1/findings/{id}           # Детали finding
PATCH  /api/v1/findings/{id}           # Обновить finding
DELETE /api/v1/findings/{id}           # Мягкое удаление

POST   /api/v1/findings/{id}/transition# Изменить статус
POST   /api/v1/findings/{id}/delegate  # Делегировать
POST   /api/v1/findings/{id}/comments  # Добавить комментарий
GET    /api/v1/findings/{id}/comments  # Список комментариев
POST   /api/v1/findings/{id}/attachments # Загрузить файл
GET    /api/v1/findings/{id}/attachments # Список файлов
DELETE /api/v1/findings/{id}/attachments/{file_id} # Удалить файл
GET    /api/v1/findings/{id}/history   # История изменений
```

### 5.9. Эндпоинты workflow

```
GET    /api/v1/workflow/statuses       # Список статусов
POST   /api/v1/workflow/statuses       # Создать статус
PATCH  /api/v1/workflow/statuses/{id}  # Обновить статус
DELETE /api/v1/workflow/statuses/{id}  # Удалить статус

GET    /api/v1/workflow/transitions    # Список переходов
POST   /api/v1/workflow/transitions    # Создать переход
PATCH  /api/v1/workflow/transitions/{id} # Обновить переход
DELETE /api/v1/workflow/transitions/{id} # Удалить переход
```

### 5.10. Эндпоинты отчетов

```
GET    /api/v1/reports/findings        # Finding report (с фильтрами)
GET    /api/v1/reports/findings/export # Экспорт в Excel
POST   /api/v1/reports/findings/email  # Отправить на email

GET    /api/v1/reports/by_processes    # По процессам
GET    /api/v1/reports/by_processes/export

GET    /api/v1/reports/by_solvers      # По исполнителям
GET    /api/v1/reports/by_solvers/export
```

### 5.11. Эндпоинты dashboard

```
GET    /api/v1/dashboard/stats         # Общая статистика
GET    /api/v1/dashboard/my_tasks      # Задачи текущего пользователя
GET    /api/v1/dashboard/approvals     # На согласовании
```

### 5.12. Эндпоинты уведомлений

```
GET    /api/v1/notifications            # Список уведомлений
POST   /api/v1/notifications/{id}/read  # Отметить прочитанным
POST   /api/v1/notifications/read_all   # Отметить все прочитанными
GET    /api/v1/notifications/stats      # Статистика уведомлений (≤7 дней)

# Админка - мониторинг очередей
GET    /api/v1/admin/notifications/queue_stats  # Статистика очередей (pending, processing, failed)
GET    /api/v1/admin/notifications/failed       # Список неотправленных уведомлений
POST   /api/v1/admin/notifications/{id}/retry   # Повторная отправка
POST   /api/v1/admin/notifications/retry_all    # Повторная отправка всех неудачных
GET    /api/v1/admin/system/health              # Состояние бэка, воркеры
```

### 5.13. Эндпоинты настроек

```
GET    /api/v1/settings                 # Все настройки системы (публичные)
GET    /api/v1/settings/categories      # Настройки по категориям
GET    /api/v1/settings/{key}           # Конкретная настройка
PATCH  /api/v1/settings/{key}           # Обновить настройку

# Интеграции (множественные подключения)
GET    /api/v1/integrations/s3_storages
POST   /api/v1/integrations/s3_storages
GET    /api/v1/integrations/s3_storages/{id}
PUT    /api/v1/integrations/s3_storages/{id}
DELETE /api/v1/integrations/s3_storages/{id}
POST   /api/v1/integrations/s3_storages/{id}/test

GET    /api/v1/integrations/email_accounts
POST   /api/v1/integrations/email_accounts
GET    /api/v1/integrations/email_accounts/{id}
PUT    /api/v1/integrations/email_accounts/{id}
DELETE /api/v1/integrations/email_accounts/{id}
POST   /api/v1/integrations/email_accounts/{id}/test

GET    /api/v1/integrations/ldap_connections
POST   /api/v1/integrations/ldap_connections
GET    /api/v1/integrations/ldap_connections/{id}
PUT    /api/v1/integrations/ldap_connections/{id}
DELETE /api/v1/integrations/ldap_connections/{id}
POST   /api/v1/integrations/ldap_connections/{id}/test

# История изменений (универсальная)
GET    /api/v1/change_history
```

---

## 6. Команда и распределение ролей

### Состав команды

| Роль | Дней | Часов | Ставка (₽/час) | Стоимость без НДС (₽) | Стоимость с НДС (₽) |
|------|------|-------|----------------|----------------------|-------------------|
| Архитектор | 8 | 64 | 4 500 | 288 000 | 345 600 |
| DevOps | 5 | 40 | 3 000 | 120 000 | 144 000 |
| Фронтенд разработчик | 21 | 162 | 2 500 | 405 000 | 486 000 |
| Бэкенд разработчик | 13 | 98 | 2 500 | 245 000 | 294 000 |
| Руководитель проекта | 5 | 40 | 3 500 | 140 000 | 168 000 |
| **ИТОГО** | **51** | **404** | - | **1 198 000** | **1 437 600** |

### Зоны ответственности

**Архитектор:**
- Проектирование архитектуры системы
- Разработка модели данных
- Проектирование API
- Кодревью критичных компонентов
- Консультации команды

**DevOps:**
- Настройка Docker окружений
- Конфигурация PostgreSQL, Redis
- Настройка CI/CD
- Деплой на PROD
- Настройка мониторинга и бэкапов

**Бэкенд разработчик:**
- Разработка FastAPI приложения (Python 3.13)
- SQLAlchemy 2.0+, async, миграции
- Реализация REST API (/api/v1)
- Интеграции (LDAP, Email, Telegram)
- Безопасность API-токенов (hash, rotate, rate limit)
- Backend тестирование

**Фронтенд разработчик:**
- Разработка React приложения
- Реализация UI компонентов
- Интеграция с API
- Мультиязычность
- Frontend тестирование

**Руководитель проекта:**
- Планирование и координация
- Коммуникация с заказчиком
- Контроль сроков и качества
- Подготовка документации
- Проведение обучения

---

## 7. План разработки (12 недель, 2.5 месяца)

### Неделя 1: Подготовка старта проекта

**Ответственные:** Руководитель проекта (8 ч), Архитектор (16 ч), DevOps (8 ч)

**Задачи:**
1. Kickoff встреча с заказчиком, согласование требований - 2 ч (РП)
2. Проработка детального ТЗ для разработки - 4 ч (РП)
3. Проектирование архитектуры системы - 8 ч (Архитектор)
4. Проектирование модели данных - 8 ч (Архитектор)
5. Настройка окружений разработки (Docker Compose) - 6 ч (DevOps)
6. Инициализация репозитория, структура проекта - 2 ч (DevOps)
7. Kickoff для команды разработки - 2 ч (РП)

**Результат:** Согласованное ТЗ, спроектированная архитектура, настроенная инфраструктура.

---

### Недели 2-4: Разработка справочников и модуля администрирования

**Ответственные:** Бэкенд разработчик (48 ч), Архитектор (16 ч), РП (4 ч)

**Задачи Backend (Бэкенд разработчик):**
1. Инициализация FastAPI проекта, структура модулей - 4 ч
2. Настройка PostgreSQL схемы, миграции - 6 ч
3. Базовые модели (core app): AbstractBaseModel, SoftDeleteMixin - 3 ч
4. Модели Enterprise, User, Role, Permission - 8 ч
5. JWT авторизация, LDAP интеграция - 8 ч
6. OTP по email, сквозная авторизация - 4 ч
7. RBAC: middleware, декораторы, права - 6 ч
8. Модели справочников (Process, Norm, AuditType, Product, Project) - 4 ч
9. API CRUD для справочников и администрирования - 5 ч

**Задачи Architecture (Архитектор):**
1. Кодревью, консультации - 8 ч
2. Проектирование API спецификации - 4 ч
3. Настройка Swagger/OpenAPI документации - 4 ч

**Задачи Management (РП):**
1. Координация команды, статус-митинги - 4 ч

**Результат:** Работающая авторизация (email, OTP, LDAP), RBAC, справочники, API документация.

---

### Недели 4-5: API Audits/Findings, фильтры, история статусов

**Ответственные:** Бэкенд разработчик (24 ч), Архитектор (8 ч), DevOps (8 ч)

**Задачи Backend:**
1. Модели Status, StatusTransition с поддержкой цветов переходов - 4 ч
2. Workflow конструктор: API, валидация переходов - 6 ч
3. Модели планирования аудитов (AuditPlan, AuditPlanItem) - 4 ч
4. Модель квалификации аудиторов (AuditorQualification) - 3 ч
5. Модель Audit со всеми полями + связь с планом + новые поля (переносы, часы, результаты) - 5 ч
6. Модель AuditComponent для компонентов/деталей (новое) - 3 ч
7. API CRUD для планов аудитов и квалификаций - 6 ч
8. API CRUD для аудитов, фильтры, пагинация - 6 ч
9. API для графика аудитов (calendar/schedule, calendar/by_component, reschedule) (новое) - 8 ч
10. API CRUD для компонентов аудитов (новое) - 4 ч
11. API для истории переносов аудитов (новое) - 2 ч
12. Модель Finding с 5xWhy анализом - 5 ч
13. API CRUD для findings, фильтры - 8 ч
14. Логика смены статусов с валидацией - 4 ч
15. Модели FindingComment, FindingAttachment - 2 ч
16. API комментарии и вложения - 3 ч
17. ChangeHistory - история изменений - 4 ч
18. Модель FindingDelegation, API - 3 ч
19. Реализация шифрования для модели `SystemSetting` (ключ из `.env`) - 4 ч

**Задачи DevOps:**
- Настройка Redis, Celery для фоновых задач - 4 ч
- Настройка хранилища файлов - 2 ч
- Оптимизация БД, индексы - 2 ч

**Задачи Architecture:**
- Кодревью критичных компонентов - 8 ч

**Результат:** Полностью работающие модули Audits и Findings с workflow.

---

### Недели 5-8: Frontend разработка основных элементов

**Ответственные:** Фронтенд разработчик (116 ч), Бэкенд (12 ч), Архитектор (8 ч), РП (8 ч)

**Задачи Frontend:**
1. Инициализация React проекта (TypeScript, Ant Design) - 4 ч
2. Настройка роутинга (React Router), Redux Toolkit - 6 ч
3. i18n (react-i18next), переводы RU/EN - 6 ч
4. Axios клиент, интеграция с API - 4 ч
5. Страница логина (email+пароль, OTP, LDAP) - 6 ч
6. Главная Dashboard со счетчиками - 6 ч
7. Страница планирования аудитов (календарь, планы) - 12 ч
8. Страница управления квалификациями аудиторов - 8 ч
9. Страница списка аудитов с фильтрами - 8 ч
10. Карточка аудита (просмотр/редактирование) - 10 ч
11. Страница списка findings с фильтрами - 10 ч
12. Карточка finding с 5xWhy (просмотр/редактирование) - 12 ч
13. Страница управления пользователями - 6 ч
14. Страница управления ролями и правами - 8 ч
15. Страницы справочников (CRUD) - 6 ч
16. Страница конструктора workflow - 4 ч
17. Страница мониторинга очередей уведомлений в пользовательской админке - 8 ч
18. Страница настроек rate limiting (email/telegram) в пользовательской админке - 6 ч
19. Страница настроек подключений (S3, SMTP, LDAP) с проверкой доступности - 8 ч

**Задачи Backend:**
- Модель Notification с расширенными полями (retry, errors) - 3 ч
- Модель NotificationQueue для управления очередью - 2 ч
- SystemSetting: расширение с категориями и публичными настройками - 2 ч
- Настройки rate limiting (email, telegram) в админке - 2 ч
- Celery задачи для батчевой отправки Email - 5 ч
- Celery задачи для батчевой отправки Telegram - 4 ч
- Retry механизм с логированием ошибок - 3 ч
- Telegram бот, привязка через ссылку - 4 ч
- API для мониторинга очередей уведомлений - 3 ч
- API для вложений с интеграцией Yandex Object Storage (pre-signed URLs) - 5 ч

**Задачи Architecture:**
- Кодревью Frontend компонентов - 4 ч
- Консультации по API интеграции - 4 ч

**Задачи Management:**
- Координация, демо для заказчика - 4 ч
- Подготовка к MVP - 4 ч

**Результат:** Полностью функциональный Frontend для ключевых модулей.

---

### Недели 7-8: Разработка встроенной отчетности и списков

**Ответственные:** Фронтенд разработчик (20 ч), Бэкенд (8 ч), Архитектор (4 ч)

**Задачи Frontend:**
1. Страница отчетов с фильтрами - 8 ч
2. Интеграция экспорта (Excel) - 6 ч
3. Страница настроек системы - 4 ч
4. Доработка UI/UX по обратной связи - 2 ч

**Задачи Backend:**
1. API отчетов (Finding report, By processes, By solvers) - 4 ч
2. Экспорт в Excel (openpyxl) - 2 ч


**Задачи Architecture:**
- Кодревью отчетов - 4 ч

**Результат:** Все 3 типа отчетов работают, экспорт Excel

---

### Недели 8-9: Тестирование

**Ответственные:** Бэкенд разработчик (16 ч), Фронтенд разработчик (12 ч), Архитектор (8 ч), РП (8 ч)

**Задачи Backend:**
1. Юнит-тесты моделей и API - 8 ч
2. Интеграционные тесты основных сценариев - 6 ч
3. Исправление найденных багов - 2 ч

**Задачи Frontend:**
1. Тестирование компонентов - 4 ч
2. E2E тесты ключевых флоу - 4 ч
3. Исправление UI багов - 4 ч

**Задачи Architecture:**
1. Оптимизация запросов БД - 4 ч
2. Проверка безопасности (OWASP Top 10) - 4 ч

**Задачи Management:**
1. Координация тестирования - 2 ч
2. Приемочное тестирование с заказчиком - 4 ч
3. Сбор обратной связи - 2 ч

**Результат:** Протестированная, стабильная система.

---

### Недели 5, 7, 9: Создание документации к ПО (параллельно)

**Ответственные:** РП (12 ч), Архитектор (8 ч)

**Задачи:**
1. Документация API (финализация Swagger) - 4 ч (Архитектор)
2. Документация архитектуры системы - 4 ч (Архитектор)
3. Инструкция по установке и настройке - 6 ч (РП)
4. Описание модулей системы - 6 ч (РП)

**Результат:** Полная техническая документация.

---

### Неделя 7, 9: Подготовка сервера PROD

**Ответственные:** DevOps (16 ч), Архитектор (4 ч)

**Задачи DevOps:**
1. Подготовка prod окружения Ubuntu 22/24 - 6 ч
2. Настройка Nginx, SSL сертификаты - 4 ч
3. Настройка бэкапов PostgreSQL - 2 ч
4. Настройка мониторинга и логирования - 2 ч
5. Проверка безопасности сервера - 2 ч

**Задачи Architecture:**
- Консультация по конфигурации - 4 ч

**Результат:** Готовый PROD сервер.

---

### Неделя 10: Запуск MVP решения

**Ответственные:** DevOps (8 ч), РП (8 ч), вся команда (поддержка)

**Задачи:**
1. Деплой MVP на PROD - 4 ч (DevOps)
2. Проверка работоспособности всех модулей - 2 ч (DevOps)
3. Демонстрация заказчику - 2 ч (РП)
4. Сбор первичной обратной связи - 2 ч (РП)
5. Горячие исправления критичных багов - 4 ч (команда)
6. Monitoring первых дней работы - 2 ч (РП)

**Результат:** MVP запущен в эксплуатацию.

---

### Неделя 11: Сбор обратной связи и исправление ошибок

**Ответственные:** Бэкенд (8 ч), Фронтенд (8 ч), РП (8 ч)

**Задачи:**
1. Сбор и приоритизация обратной связи - 4 ч (РП)
2. Исправление выявленных ошибок Backend - 8 ч (Бэкенд)
3. Исправление выявленных ошибок Frontend - 8 ч (Фронтенд)
4. Подготовка документации для пользователей - 8 ч (РП)
5. Регрессионное тестирование - 4 ч (команда)

**Результат:** Исправлены ошибки, подготовлена пользовательская документация.

---

### Неделя 12: Запуск финальной версии ПО и обучение пользователей

**Ответственные:** РП (16 ч), DevOps (4 ч)

**Задачи:**
1. Деплой финальной версии - 2 ч (DevOps)
2. Финальная проверка системы - 2 ч (DevOps)
3. Проведение обучения для администраторов - 6 ч (РП)
4. Проведение обучения для пользователей - 6 ч (РП)
5. Передача документации - 2 ч (РП)
6. Передача кодабазы и доступов - 2 ч (РП)

**Результат:** Система запущена, пользователи обучены, проект передан заказчику.

---

## 8. Детализированная оценка трудозатрат по ролям

### Распределение часов по специалистам

| Роль | Часы | Основные задачи |
|------|------|----------------|
| **Архитектор** | **64 ч** | Проектирование архитектуры и модели данных, кодревью, консультации |
| **DevOps** | **40 ч** | Инфраструктура, Docker, БД, деплой, мониторинг |
| **Бэкенд разработчик** | **111 ч** | FastAPI, API, бизнес-логика, интеграции, батчевые уведомления, шифрование |
| **Фронтенд разработчик** | **170 ч** | React, UI компоненты, интеграция с API, мониторинг уведомлений, подключения |
| **Руководитель проекта** | **40 ч** | Координация, документация, обучение |
| **ИТОГО** | **404 ч** | |

### Детальное распределение задач

**Архитектор (64 часа):**
- Проектирование архитектуры системы - 8 ч
- Проектирование модели данных - 8 ч
- Проектирование API спецификации - 4 ч
- Настройка Swagger/OpenAPI - 4 ч
- Кодревью RBAC и справочников - 8 ч
- Кодревью Audits/Findings - 8 ч
- Кодревью Frontend компонентов - 4 ч
- Консультации по API интеграции - 4 ч
- Кодревью отчетов - 4 ч
- Оптимизация запросов БД - 4 ч
- Проверка безопасности - 4 ч
- Консультация по конфигурации PROD - 4 ч

**DevOps (40 часов):**
- Настройка Docker Compose окружений - 6 ч
- Инициализация репозитория, структура - 2 ч
- Настройка Redis, Celery - 4 ч
- Настройка хранилища файлов - 2 ч
- Оптимизация БД, индексы - 2 ч
- Подготовка PROD окружения Ubuntu - 6 ч
- Настройка Nginx, SSL сертификаты - 4 ч
- Настройка бэкапов PostgreSQL - 2 ч
- Настройка мониторинга и логирования - 2 ч
- Проверка безопасности сервера - 2 ч
- Деплой MVP на PROD - 4 ч
- Проверка работоспособности - 2 ч
- Деплой финальной версии - 2 ч

**Бэкенд разработчик (111 часов):**
- Инициализация FastAPI проекта, структура модулей - 4 ч
- Настройка PostgreSQL, миграции - 6 ч
- Базовые модели (core) - 3 ч
- Модели Enterprise, User, Role, Permission - 8 ч
- JWT, LDAP, OTP авторизация - 12 ч
- RBAC: middleware, декораторы, API - 6 ч
- Модели справочников, API CRUD - 9 ч
- Модели Status, StatusTransition с цветами - 4 ч
- Workflow конструктор, валидация - 6 ч
- Модели планирования аудитов (AuditPlan, AuditPlanItem) - 4 ч
- Модель квалификации аудиторов (AuditorQualification) - 3 ч
- Модель Audit с новыми полями (переносы, часы, результаты) - 5 ч
- Модель AuditComponent (новое) - 3 ч
- API CRUD для планов аудитов и квалификаций - 6 ч
- API CRUD для аудитов - 6 ч
- API для графика аудитов (calendar/schedule, by_component) (новое) - 8 ч
- API для переносов аудитов и истории (новое) - 4 ч
- API CRUD для компонентов (новое) - 4 ч
- Модель Finding, API CRUD - 13 ч
- FindingComment, FindingAttachment - 2 ч
- API для вложений с интеграцией Yandex Object Storage (pre-signed URLs) - 5 ч
- ChangeHistory - 4 ч
- FindingDelegation - 3 ч
- Реализация шифрования для модели `SystemSetting` (ключ из `.env`) - 4 ч
- Модели Notification и NotificationQueue с расширенными полями - 5 ч
- SystemSetting с категориями и публичными настройками - 2 ч
- Настройки rate limiting в админке - 2 ч
- Celery батчевая отправка Email - 5 ч
- Celery батчевая отправка Telegram - 4 ч
- Retry механизм с логированием - 3 ч
- Telegram бот - 4 ч
- API мониторинга очередей уведомлений - 3 ч
- API отчетов, экспорт Excel - 8 ч
- Юнит и интеграционные тесты - 16 ч
- Исправление багов MVP - 8 ч

**Фронтенд разработчик (170 часов):**
- Инициализация React проекта - 4 ч
- Роутинг, Redux Toolkit - 6 ч
- i18n, переводы RU/EN - 6 ч
- Axios клиент, API интеграция - 4 ч
- Страница логина - 6 ч
- Dashboard со счетчиками - 6 ч
- Страница планирования аудитов (календарь, планы) - 12 ч
- Страница управления квалификациями аудиторов - 8 ч
- Список аудитов с фильтрами - 8 ч
- Карточка аудита - 10 ч
- Список findings с фильтрами - 10 ч
- Карточка finding с 5xWhy - 12 ч
- Управление пользователями - 6 ч
- Управление ролями и правами - 8 ч
- Справочники (CRUD) - 6 ч
- Конструктор workflow - 4 ч
- Страница мониторинга очередей уведомлений - 8 ч
- Страница настроек rate limiting - 6 ч
- Страница настроек подключений (S3, SMTP, LDAP) с проверкой доступности - 8 ч
- Страница отчетов - 8 ч
- Интеграция экспорта (Excel) - 6 ч
- Страница настроек системы - 4 ч
- Доработка UI/UX - 2 ч
- Тестирование компонентов - 4 ч
- E2E тесты - 4 ч
- Исправление UI багов MVP - 12 ч

**Руководитель проекта (40 часов):**
- Kickoff с заказчиком - 2 ч
- Проработка детального ТЗ - 4 ч
- Kickoff для команды - 2 ч
- Координация, статус-митинги - 8 ч
- Демо для заказчика - 4 ч
- Подготовка к MVP - 4 ч
- Координация тестирования - 2 ч
- Приемочное тестирование - 4 ч
- Сбор обратной связи - 4 ч
- Инструкция по установке - 6 ч
- Описание модулей - 6 ч
- Monitoring после MVP - 2 ч
- Сбор и приоритизация ОС - 4 ч
- Документация для пользователей - 8 ч
- Обучение администраторов - 6 ч
- Обучение пользователей - 6 ч
- Передача документации и доступов - 4 ч

---

## 10. Финансовая оценка

### Стоимость базовой разработки

| Роль | Часов | Ставка (₽/час) | Стоимость без НДС (₽) | НДС 20% (₽) | Стоимость с НДС (₽) |
|------|-------|----------------|----------------------|------------|-------------------|
| Архитектор | 64 | 4 500 | 288 000 | 57 600 | 345 600 |
| DevOps | 40 | 3 000 | 120 000 | 24 000 | 144 000 |
| Фронтенд разработчик | 162 | 2 500 | 405 000 | 81 000 | 486 000 |
| Бэкенд разработчик | 98 | 2 500 | 245 000 | 49 000 | 294 000 |
| Руководитель проекта | 40 | 3 500 | 140 000 | 28 000 | 168 000 |
| **ИТОГО** | **404** | - | **1 198 000** | **239 600** | **1 437 600** |

### Фиксированная стоимость проекта

**Базовая разработка:** **1 198 000 ₽** (без НДС) / **1 437 600 ₽** (с НДС)

**Включено в стоимость:**
- Все модули согласно ТЗ (Dashboard, Audits, Findings, Reports, Administration, Planning)
- Планирование аудитов (календарь, планы, назначение аудиторов)
- Управление квалификациями аудиторов
- Авторизация (Email+пароль, OTP, LDAP, сквозная авторизация)
- RBAC с настройкой прав через админку
- Визуальный конструктор workflow
- Интеграции: Active Directory, Yandex Mail, Telegram
- Уведомления Email + Telegram с батчевой отправкой и retry механизмом
- Мониторинг очередей уведомлений в пользовательской админке
- Настройка rate limiting для email/telegram в пользовательской админке
- 3 типа отчетов с экспортом Excel
- Мультиязычность (русский, английский)
- REST API с JWT токенами
- Деплой на PROD
- Документация (техническая + пользовательская)
- Обучение (администраторы + пользователи)

---




---

## 10. Риски и митигация

| Риск | Вероятность | Влияние | Митигация |
|------|-------------|---------|-----------|
| Задержка доступа к AD/LDAP | Средняя | 0.5-1 нед | Запросить доступы заранее, разработать без LDAP, добавить после |
| Изменение бизнес-правил workflow | Средняя | +10-20 ч | Заморозить требования после недели 3, изменения — отдельно |
| Расширение отчетов сверх базовых | Низкая | +8-24 ч | Четко зафиксировать 3 отчета в ТЗ |
| Импорт данных из старой системы | Средняя | +12-40 ч | Уточнить необходимость сразу, если нужно — отдельная итерация |
| Инфраструктурные задержки (сервер, сертификаты) | Низкая | 0.5 нед | Резерв времени, параллельная разработка |
| Недостаточное описание прав доступа | Средняя | +5-15 ч | Создать матрицу прав на неделе 1-2 |
| Проблемы производительности БД | Низкая | +4-8 ч | Индексы с самого начала, тестирование на неделе 10 |
| Недостаточная пропускная способность SMTP/Telegram API | Низкая | +3-6 ч | Rate limiting, очереди Celery |

---

## 11. Допущения

1. Сервер Ubuntu 22/24 LTS, доступы предоставлены к неделе 7
2. SMTP Yandex и домен для email настроены, доступы предоставлены к неделе 1
3. Telegram бот создан, токен предоставлен к неделе 5
4. Тестовый доступ к AD/LDAP предоставлен к неделе 2
5. Доступы к Yandex Object Storage (service account key, bucket name) предоставлены к неделе 1
6. Только русский и английский языки интерфейса
7. Интеграции с другими системами кроме AD, Email, Telegram не требуются
8. Импорт исторических данных не входит в базовую разработку
9. Мобильное приложение не входит в текущую итерацию
10. Команда работает с частичной занятостью (не full-time)

---

## 12. Критерии приемки

### MVP (неделя 10):
- [ ] Пользователи могут войти через email+пароль, OTP и LDAP
- [ ] Сквозная авторизация для доменных пользователей работает
- [ ] Можно создавать и редактировать аудиты
- [ ] Можно создавать и редактировать findings с 5xWhy анализом
- [ ] Работает смена статусов findings с валидацией
- [ ] Можно делегировать findings
- [ ] Можно добавлять комментарии и вложения
- [ ] Работают уведомления на email
- [ ] Telegram уведомления работают
- [ ] Работают все 3 типа отчетов с экспортом Excel
- [ ] Dashboard отображает актуальную статистику
- [ ] RBAC работает, права настраиваются через админку
- [ ] Workflow конструктор функционален
- [ ] Система развернута на PROD

### Полная версия (неделя 12):
- [ ] Все замечания после MVP исправлены
- [ ] Система стабильно работает под нагрузкой
- [ ] Все справочники настраиваются через админку
- [ ] История изменений фиксируется корректно
- [ ] Мягкое удаление работает для всех сущностей
- [ ] API документация (Swagger) актуальна
- [ ] Техническая документация передана
- [ ] Пользовательская документация передана
- [ ] Проведено обучение администраторов (6 часов)
- [ ] Проведено обучение пользователей (6 часов)
- [ ] Код передан заказчику
- [ ] Доступы переданы заказчику

---

## 13. Контакты и согласование

**Разработчик:**
- ФИО: [указать]
- Email: [указать]
- Telegram: [указать]

**Заказчик:**
- Компания: MGC
- Контактное лицо: [указать]
- Email: [указать]

**Дата согласования:** [указать после ответов на вопросы]

**Подписи:**

Разработчик: ________________

Заказчик: ________________

